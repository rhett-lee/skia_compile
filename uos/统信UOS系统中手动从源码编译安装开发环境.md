# 统信UOS系统中手动从源码编译安装开发环境 - 修改日期：2025-05-25 - 操作系统：统信UOS桌面专业版AMD64（1070 HWE版本）## 一、准备工作：安装必备的软件1. 安装完成系统后，可用升级系统到最新：    （1）升级系统：`sudo apt update`    （2）升级系统：`sudo apt upgrade -y`   2. 安装依赖的软件```sudo apt install -y gcc g++ gdb make git cmake python3 ninja-build wget unzip```安装完成后的各个软件版本信息如下：```cmake 已经是最新版 (3.22.1.1-1)。g++ 已经是最新版 (4:8.3.0-1+sign)。gcc 已经是最新版 (4:8.3.0-1+sign)。gdb 已经是最新版 (8.2.1.1-1+security)。git 已经是最新版 (1:2.20.1.3-2+dde)。make 已经是最新版 (4.2.1.1-1+dde)。ninja-build 已经是最新版 (1.8.2-1)。python3 已经是最新版 (3.7.3.1-deepin1)。unzip 已经是最新版 (6.0.7.2-1+deepin+sign)。wget 已经是最新版 (1.20.1.6-deepin1)。```说明：系统默认提供的开发工具软件版本太低，当不能满足要求时，需要使用源码编译开发工具的最新版，包括binutils、python3、gcc/g++、llvm/clang/clang++、gn等。    # 二、手工从源码编译安装开发环境最低内存需求：16GB，内存不足时编译失败    硬盘空间需求：35GB左右    1. 编译安装最新版本的binutils（因系统自带的版本较低，使用ld/gold链接gcc/g++/llvm/clang/clang++的时候，会遇到错误）      ```#!/bin/bashcd ~/develop; mkdir src                                  #创建源码目录cd ~/develop/src                                         #设置工作目录wget https://ftp.gnu.org/gnu/binutils/binutils-2.43.1.tar.gz #下载源码tar -xzf binutils-2.43.1.tar.gz                              #解压源码cd binutils-2.43.1                                           #进入源码目录./configure --prefix=~/develop/install/binutils-2.43.1/ --disable-werror --enable-gprofng=no #运行配置脚本  #备注：使用`--enable-gprofng=no`选项是因为gprofng的源码有编译错误。    make                                                         #编译make install                                                 #安装``` 2. 从源码编译安装python3的较新版本（3.13.0），因系统自带的版本(3.7.3)太低，无法编译llvm，所以必须升级    ```#!/bin/bashcd ~/develop/src                                                #设置工作目录wget https://www.python.org/ftp/python/3.13.0/Python-3.13.0.tar.xz  #下载源码tar -xJf Python-3.13.0.tar.xz                                       #解压源码cd Python-3.13.0                                                    #进入源码目录./configure --prefix=~/develop/install/Python-3.13.0/           #运行配置脚本make                                                                #编译make install                                                        #安装, 会遇到错误，但不影响。```3. 从源码编译安装gcc/g++ 的较新版本（14.2.0），因系统自带的版本太低，必须升级   ```#!/bin/bash# 编译资源需求：4GB内存，磁盘空间：12GBcd ~/develop/src                                            #设置工作目录wget https://ftp.gnu.org/gnu/gcc/gcc-14.2.0/gcc-14.2.0.tar.gz   #下载源码tar -xzf gcc-14.2.0.tar.gz                                      #解压源码cd ~/develop/src/gcc-14.2.0                                 #进入gcc-14.2.0源码目录./contrib/download_prerequisites                                #下载编译时依赖的第三方库#配置（说明：由于UOS自带的ld(v2.31.1)链接gcc/g++时失败，所以使用源码编译安装的最新版ld(v2.43.1)）mkdir -p ~/develop/src/gcc-14.2.0.buildcd ~/develop/src/gcc-14.2.0.buildexport LD="~/develop/install/binutils-2.43.1/bin/ld"../gcc-14.2.0/configure --prefix=~/develop/install/gcc-14.2.0 --disable-multilib --enable-ld --enable-bootstrap#注意：运行configure的过程中，如果遇到错误，请留意系统的安全拦截提示，按照安全拦截提示，允许任意程序执行即可。   make -j 12                                                      #编译：多进程编译，编译参数可参考电脑实际有几个核心make install                                     #安装，安装目录为：~/develop/install/gcc-14.2.0``` 编译安装完成后，设置环境变量，以使新版gcc/g++可用（将下列内容放在/home/develop/source.sh文件中，便于使用:`source ~/develop/source.sh`）：    ```#!/bin/bash# python3 export PATH=~/develop/install/Python-3.13.0/bin/:$PATH# binutilsexport PATH=~/develop/install/binutils-2.43.1/bin/:$PATH# gcc/g++ 14.2export PATH=~/develop/install/gcc-14.2.0/bin/:$PATHexport LD_LIBRARY_PATH=~/develop/install/gcc-14.2.0/lib64/:$LD_LIBRARY_PATHexport C_INCLUDE_PATH=~/develop/install/gcc-14.2.0/include/c++/14.2.0/:~/develop/install/gcc-14.2.0/include/c++/14.2.0/x86_64-pc-linux-gnu/:$C_INCLUDE_PATHexport CPLUS_INCLUDE_PATH=~/develop/install/gcc-14.2.0/include/c++/14.2.0/:~/develop/install/gcc-14.2.0/include/c++/14.2.0/x86_64-pc-linux-gnu/:$CPLUS_INCLUDE_PATH```    4. 从源码编译安装llvm/clang/clang++的较新版本（19.1.3），因系统自带的版本太低，必须升级    ```#!/bin/bash#编译资源需求：16GB内存cd ~/develop/src                                                              #设置工作目录wget https://github.com/llvm/llvm-project/archive/refs/tags/llvmorg-19.1.3.tar.gz #下载源码tar -xzf llvmorg-19.1.3.tar.gz                                                    #解压源码source ~/develop/source.sh                                                    #使用gcc/g++最新版#生成编译配置cmake -S ./llvm-project-llvmorg-19.1.3/llvm/ -B ./llvm-project-llvmorg-19.1.3.build \      -G Ninja \      -DLLVM_ENABLE_PROJECTS="clang;lld" \      -DCMAKE_BUILD_TYPE=Release \      -DCMAKE_C_COMPILER=~/develop/install/gcc-14.2.0/bin/gcc \      -DCMAKE_CXX_COMPILER=~/develop/install/gcc-14.2.0/bin/g++ \      -DCMAKE_INSTALL_PREFIX=~/develop/install/LLVM-19.1.3ninja -C ./llvm-project-llvmorg-19.1.3.build                                        #编译源码ninja -C ./llvm-project-llvmorg-19.1.3.build install           #安装，安装目录为:~/develop/install/LLVM-19.1.3```设置环境变量，以使新版llvm/clang/clang++可用（将下列内容放在/home/develop/source.sh文件中，便于使用:`source ~/develop/source.sh`）：    ```#!/bin/bash# python3 export PATH=~/develop/install/Python-3.13.0/bin/:$PATH# binutilsexport PATH=~/develop/install/binutils-2.43.1/bin/:$PATH# gcc/g++ 14.2export PATH=~/develop/install/gcc-14.2.0/bin/:$PATHexport LD_LIBRARY_PATH=~/develop/install/gcc-14.2.0/lib64/:$LD_LIBRARY_PATHexport C_INCLUDE_PATH=~/develop/install/gcc-14.2.0/include/c++/14.2.0/:~/develop/install/gcc-14.2.0/include/c++/14.2.0/x86_64-pc-linux-gnu/:$C_INCLUDE_PATHexport CPLUS_INCLUDE_PATH=~/develop/install/gcc-14.2.0/include/c++/14.2.0/:~/develop/install/gcc-14.2.0/include/c++/14.2.0/x86_64-pc-linux-gnu/:$CPLUS_INCLUDE_PATH# llvm/clang/clang++export PATH=~/develop/install/LLVM-19.1.3/bin/:$PATHexport LD_LIBRARY_PATH=~/develop/install/LLVM-19.1.3/lib/:$LD_LIBRARY_PATHexport C_INCLUDE_PATH=~/develop/install/LLVM-19.1.3/include/:$C_INCLUDE_PATHexport CPLUS_INCLUDE_PATH=~/develop/install/LLVM-19.1.3/include/:$CPLUS_INCLUDE_PATH```    5. 从源码编译安装gn（没找到系统自带的，所以从源码编译）：    ```#!/bin/bashcd ~/develop/src                            #设置工作目录git clone https://github.com/rhett-lee/gn.git   #下载源码cd ~/develop/src/gn                         #进入源码目录source ~/develop/source.sh                  #使用gcc/g++最新版export CXX=g++; python3 build/gen.py            #生成编译配置ninja -C out                                    #编译源码```    设置环境变量，以使gn可用（将下列内容放在/home/develop/source.sh文件中，便于使用:`source ~/develop/source.sh`）：    ```#!/bin/bash# python3 export PATH=~/develop/install/Python-3.13.0/bin/:$PATH# binutilsexport PATH=~/develop/install/binutils-2.43.1/bin/:$PATH# gcc/g++ 14.2export PATH=~/develop/install/gcc-14.2.0/bin/:$PATHexport LD_LIBRARY_PATH=~/develop/install/gcc-14.2.0/lib64/:$LD_LIBRARY_PATHexport C_INCLUDE_PATH=~/develop/install/gcc-14.2.0/include/c++/14.2.0/:~/develop/install/gcc-14.2.0/include/c++/14.2.0/x86_64-pc-linux-gnu/:$C_INCLUDE_PATHexport CPLUS_INCLUDE_PATH=~/develop/install/gcc-14.2.0/include/c++/14.2.0/:~/develop/install/gcc-14.2.0/include/c++/14.2.0/x86_64-pc-linux-gnu/:$CPLUS_INCLUDE_PATH# llvm/clang/clang++export PATH=~/develop/install/LLVM-19.1.3/bin/:$PATHexport LD_LIBRARY_PATH=~/develop/install/LLVM-19.1.3/lib/:$LD_LIBRARY_PATHexport C_INCLUDE_PATH=~/develop/install/LLVM-19.1.3/include/:$C_INCLUDE_PATHexport CPLUS_INCLUDE_PATH=~/develop/install/LLVM-19.1.3/include/:$CPLUS_INCLUDE_PATH# gnexport PATH=~/develop/src/gn/out/:$PATH```    ## 三、资源链接1. Skia的编译文档库，点击访问：[skia_compile](https://github.com/rhett-lee/skia_compile) 2. nim_duilib的代码库，点击访问：[nim_duilib](https://github.com/rhett-lee/nim_duilib) 